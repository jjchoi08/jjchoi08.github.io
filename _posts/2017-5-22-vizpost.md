---
layout: single
title: Visualizaing with Plot.ly & D3
---

I enjoy creating visualizations as much as doing exploratory analysis. In fact, I enjoy it more than creating predictive model. In last few months, I have learned many different tools for visuazliations but I mostly interacted with matplotlib. Matplotlib is good for exploratory analysis but if you are presenting the visualization to someone or highlight your findings in a more visually attractive way, there are many other tools that does the job.

Since I am a Python user, I still like my visualization to be visible in Jupyter notebook as I write code. I like creating visualization programmatically than using any ready-to-use tools because I want to customize as much as I want. I think plotly is one of the best visualization libraries for Python in that sense. It's compatible with many other tools and languages and you can simply embed your plot.ly visuazliation anywhere such as Jupyter notebook, github blog, html, powerpoint presentation, etc. And most importantly, you can create an interactive charts. 


## Plotly

Here's a simple bar + line chart I created for a company. With few lines of codes, it displays nice looking bar chart with mouse-over tool-tip. 

```python
data = [
    go.Bar(x=hour_df['delivery_hour'], y=hour_df['count'], name='Total Orders'),
    go.Scatter(x=hour_df['delivery_hour'], y=hour_df['count'],mode='lines+markers',hoverinfo='skip')]
layout = go.Layout(
    title="Total Orders by Hour",
    showlegend=False,
    xaxis=dict(autotick=False, title="Hour"),
    yaxis=dict(title="Total Orders")
)
fig = go.Figure(data=data, layout=layout)
py.iplot(fig)
```
<iframe width="900" height="800" frameborder="0" scrolling="no" src="//plot.ly/~jjc544/76.embed"></iframe>

You can also write code in JSON like format to create Plotly chart. Here's an example of a multip pie chart created for the same company as above. 

```python
fig = {
    'data': [{'labels': issue_df2.index,
              'values': issue_df2['chi'],
              'type': 'pie',
              'name' : 'Chicago',
              'text':'Chicago',
              'hole':0.3,
              'textposition':'inside',
              'domain': {'x': [0, 0.266]}},
            {'labels': issue_df2.index,
              'values': issue_df2['nyc'],
              'type': 'pie',
             'name':'New York City',
            'text':'New York City',
             'hole':0.3,
              'textposition':'inside',
              'domain': {'x': [0.366, 0.633]}},
            {'labels': issue_df2.index,
              'values': issue_df2['sf'],
              'type': 'pie',
             'name':'San Francisco',
            'text':'San Francisco',
             'hole':0.3,
  'textposition':'inside',
  'domain': {'x': [0.733, 1]}}],
    'layout': {'title': 'Total Reported Issues between 5/2/14 and 6/2/14',
              "annotations": [
            {
                "font": {
                    "size": 12
                },
                "showarrow": False,
                "text": "CHI",
                "x": 0.1,
                "y": 0.5
            },
            {
                "font": {
                    "size": 12
                },
                "showarrow": False,
                "text": "NYC",
                "x": 0.495,
                "y": 0.5
            },
            {
                "font": {
                    "size": 13
                },
                "showarrow": False,
                "text": "SF",
                "x": 0.89,
                "y": 0.5
            }
              ]}}

py.iplot(fig)
```


<iframe width="900" height="800" frameborder="0" scrolling="no" src="//plot.ly/~jjc544/109.embed"></iframe>

Plotly has become my go-to visualization tool. When I need to create visualizations quickly from Python data analysis or when you need a quick fix for your charts, you can also edit Plotly chart from their web-based dashboard and create presentation slide. 

You can learn more about Plotly <a href="https://plot.ly/">here</a>. Plotly holds <a href="https://plotcon.plot.ly/">Plotcon</a> twice a year or so and I am hoping to attend Plotcon 2017 in NYC this November. 


## D3.js

When it comes to interactive plots, <a href="https://d3js.org/">D3</a> is probably the most powerful one out there today. It's Javascript based and it's capability is limitless in terms of what you can create as a visualization. You can add animations, click and mouse-ove events, buttons and text fields, etc because it's Javascript + HTML + CSS. 

My very first job was a web developer. Althought I worked with C# and .NET, I often interacted with Javascript and CSS so it was easy for me to understand how D3 works. However, D3.js is not something you can use to quickly create visualization for exploratory analysis. This requires design and testing process as well as writing code for visualization itself. It's a tool for telling a compelling story from data. Creating D3.js chart takes time for me but when I have enough time to work on something and want to impress the audience, I would always go for D3.js. 

Here's a simple example of a D3.js bubble chart I created recently. I used a dataset provided by <a href="https://www.kaggle.com/momanyc/museum-collection">The Museum of Modern Art</a> from Kaggle. It's an interesting data that I am working with right now for an interactive visualization. I took a part of the whole viz for this blog post. It's 100 artists with most number of artworks at MOMA as a bubble chart. 

Check out my Simpsons's post for another exmaple of D3.js.

<script src="https://d3js.org/d3.v4.min.js"></script>


<svg width="750" height="650" font-family="sans-serif" font-size="8.5" text-anchor="middle"></svg>




<script type="text/javascript">

var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");

var format = d3.format(",d");

var color = d3.scaleOrdinal(d3.schemeCategory20c);

var pack = d3.pack()
    .size([width, height])
    .padding(1.5);

d3.csv("https://jjchoi08.github.io/DSProj/data/artist_count.csv", function(d) {
  d.value = +d.value;
  if (d.value) return d;
}, function(error, classes) {
  if (error) throw error;

  var root = d3.hierarchy({children: classes})
      .sum(function(d) { return d.value; })
      .each(function(d) {
        if (id = d.data.id) {
          var id, i = id.lastIndexOf(".");
          d.id = id;
          d.package = id.slice(0, i);
          d.class = id.slice(i + 1);
        }
      });

  var node = svg.selectAll(".node")
    .data(pack(root).leaves())
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("circle")
      .attr("id", function(d) { return d.id; })
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return color(d.package); });

  node.append("clipPath")
      .attr("id", function(d) { return "clip-" + d.id; })
    .append("use")
      .attr("xlink:href", function(d) { return "#" + d.id; });

  node.append("text")
      .attr("clip-path", function(d) { return "url(#clip-" + d.id + ")"; })
    .selectAll("tspan")
    .data(function(d) { return d.class.split(/(?=[A-Z][^A-Z])/g); })
    .enter().append("tspan")
      .attr("x", 0)
      .attr("y", function(d, i, nodes) { return 13 + (i - nodes.length / 2 - 0.5) * 10; })
      .text(function(d) { return d; });

  node.append("title")
      .text(function(d) { return d.id + "\n" + format(d.value); });
});

</script>



Many data analysts today use Tableau or Prezi for visualizations. Using these tools don't require coding and the outcome is great. However, I think being able to write code to customize your own visualization is really valuable skill as an analyst. I believe knowing how to create visualization programmatically is like understanding the math behind machine learning algorithms. I will post about another D3.js viz soon. 

Thanks!

